<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<meta content='IE=edge;chrome=1' http-equiv='X-UA-Compatible'>
<meta content='width=device-width, initial-scale=1' name='viewport'>
<title>
Minim OSD
</title>
<link href="../../../../../assets/stylesheets/all-2114de37.css" rel="stylesheet" />
<script src="../../../../../assets/javascripts/all-eb5fa4eb.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-7406390-2', 'auto');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');
  
    // outbound link tracking
    // http://www.sitepoint.com/track-outbound-links-google-analytics/
    (function($) {
      "use strict";
      // current page host
      var baseURI = window.location.host;
      // click event on body
      $("body").on("click", function(e) {
        // abandon if link already aborted or analytics is not available
        if (e.isDefaultPrevented() || typeof ga !== "function") return;
        // abandon if no active link or link within domain
        var link = $(e.target).closest("a");
        if (link.length != 1 || baseURI == link[0].host) return;
        // cancel event and record outbound link
        e.preventDefault();
        var href = link[0].href;
        ga('send', {
          'hitType': 'event',
          'eventCategory': 'outbound',
          'eventAction': 'link',
          'eventLabel': href,
          'hitCallback': loadPage
        });
        // redirect after one second if recording takes too long
        setTimeout(loadPage, 1000);
        // redirect to outbound page
        function loadPage() {
          document.location = href;
        }
      });
    })(jQuery);
</script>

<link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/blog/feed.xml" />
</head>
<body>
<nav class='navbar navbar-default' id='top' role='navigation'>
<div class='container'>
<div class='navbar-header'>
<div class='navbar-brand'>
<a href='/blog/'>
<img src="../../../../../assets/images/home/smile-0a95f89f.jpg" />
</a>
<span>Minim OSD</span>
</div>
<button class='navbar-toggle' data-target='.navbar-collapse' data-toggle='collapse' type='button'>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
</button>
<div class='navbar-right collapse navbar-collapse' id='bs-nav-collapse'>
<ul class='nav navbar-nav'>
<li>
<form class='search navbar-form' role='search'>
<div class='form-group'>
<input class='form-control bloodhound typeahead' data-articles='[["Rctimer BeerotorF3 Flight Controller","/blog/2016/02/03/rctimer-beerotorf3-flight-controller/"],["BlHeli ESCs","/blog/2015/12/06/blheli-esc-identification/"],["BlHeli ESC Upgrading and Configuration","/blog/2015/12/06/blheli-configuration/"],["BlHeli CleanFlight ESC Calibration","/blog/2015/12/06/blheli-calibration/"],["Rctimer Micro 160 BeeRotor Build, Setup and Review","/blog/2015/12/05/rctimer-micro-160-beerotor-build-setup-and-review/"],["Flashing SiLabs xRotor 20a with BlHeli via C2 4w-if","/blog/2015/11/16/flashing-xrotor-20a-with-blheli-via-4w-if/"],["Rctimer OZE32 / RTFQ Flip32 AIO Integrated Flight Controller Review and Setup","/blog/2015/11/09/rctimer-oze32-integrated-flight-controller-review-and-setup/"],["Rooting Marshmellow, keeping SELinux","/blog/2015/11/03/rooting-marshmellow-keeping-selinux/"],["MultiRotor Setup Checklist","/blog/2015/10/29/multirotor-setup-checklist/"],["ST-LINK flash and debug on the SPRacingF3","/blog/2015/10/24/st-link-flash-and-debug-on-the-spracingf3-discovery/"],["Debugging Android Native (NDK) Apps","/blog/2015/09/27/debugging-android-native-ndk-apps/"],["Fixing an Arduino 0x000000 Error","/blog/2015/09/16/fixing-an-arduino-0x000000-error/"],["GPS VK16U6 CleanFlight Setup","/blog/2015/08/26/gps-vk16u6-cleanflight-setup/"],["Go FPV Latency Testing","/blog/2015/08/24/go-fpv-latency-testing/"],["Building Android on Ubuntu 14.04","/blog/2015/07/23/building-android-on-ubuntu-14-04/"],["Migrating to Amazon Elastic Map Reduce (EMR)","/blog/2015/07/15/migrating-to-amazon-elastic-map-reduce-emr/"],["Naze32 ST-Link Debugging","/blog/2015/07/06/naze32-st-link-debugging/"],["Decompiling an APK","/blog/2015/06/30/decompiling-an-apk/"],["Nexpose Community Edition copy Scan Template","/blog/2015/06/17/nexpose-community-edition-copy-scan-template/"],["Wireless Video Tx/Rx FPV Channels","/blog/2015/06/17/boscam-tx-rx-fpv-channels/"],["Making a UHF 433mhz Inverted Vee Antenna Set","/blog/2015/06/15/making-a-uhf-433mhz-inverted-vee-antenna-set/"],["Setup OrangeLRS with OpenLRSng","/blog/2015/05/21/setup-orangelrs-with-openlrsng/"],["Go FPV Goggles","/blog/2015/05/21/go-fpv-goggles/"],["FPV250 with Cleanflight, Minimosd, OpenLRSng and a Xiaomi Yi GoPro Clone","/blog/2015/05/19/fpv250-cleanflight/"],["Flashing BlHeli on HobbyKing BlueSeries 12a ESCs With a Chinese Arduino Nano Clone","/blog/2015/05/15/flashing-blheli-on-hobbyking-blueseries-12a-escs-with-a-chinese-arduino-nano-clone/"],["Flashing NodeMCU on the ESP8266","/blog/2015/05/14/flashing-nodemcu-on-the-esp8266/"],["Ebay HC-05 Bluetooth Setup Guide","/blog/2015/05/12/ebay-hc-05-bluetooth-setup-guide/"],["3D Camera on the Tricopter","/blog/2015/05/12/3d-camera-on-the-tricopter/"],["ProRes editing in Photoshop","/blog/2015/05/11/prores-editing-in-photoshop/"],["Xiaomi Yi -- The Ant Camera","/blog/2015/05/08/xiaomi-yi-the-ant-camera/"],["Minim OSD","/blog/2015/04/22/minim-osd/"],["Flashing BlHeli on HobbyKing F20 ESCs With a Chinese Arduino Nano Clone","/blog/2015/04/20/flashing-blheli-on-hobbyking-f20-escs-with-a-chinese-arduino-nano-clone/"],["Handling Dates in Hadoop Pig","/blog/2015/04/17/handling-dates-in-hadoop-pig/"],["LiPo Battery Price Analysis","/blog/2015/04/10/lipo-battery-price-analysis/"],["ADB over WiFi (aka, how do I debug when using USB host mode?)","/blog/2015/03/27/adb-over-wifi-aka-how-do-i-debug-when-using-usb-host-mode/"],["Shrink a linux VM on OSX","/blog/2015/03/18/shrink-a-linux-vm-on-osx/"],["Mounting a VHD NTFS image on Ubuntu","/blog/2015/02/27/mounting-a-vhd-ntfs-image-on-ubuntu/"],["Ubuntu on the Beaglebone Black","/blog/2015/01/16/ubuntu-on-the-beaglebone-black/"],["Configuring the HK-T6A for a Flight Simulator","/blog/2015/01/02/configuring-the-hk-t6a-for-a-flight-simulator/"],["A complete noob&#x0027;s guide to RC","/blog/2015/01/02/a-complete-noobs-guide-to-rc/"],["DropCam on a Captive Portal","/blog/2014/11/17/dropcam-on-a-captive-portal/"],["Java reversing tips","/blog/2014/09/18/java-reversing-tips/"],["Ooize Data Pipeline Done-Flag","/blog/2014/09/02/oozie-data-pipeline-done-flag/"],["Time Machine on exFat","/blog/2014/08/06/Time_Machine_on_exFat/"],["Optimizing Postgresql","/blog/2014/01/31/Optimizing_Postgresql/"],["Mail Maker","/blog/2014/01/24/Mail_Maker/"],["Angularjs and Rails","/blog/2013/07/12/Angularjs_and_Rails/"],["nginx ssl chained certs","/blog/2013/04/24/nginx_ssl_chained_certs/"],["rails log tagging","/blog/2013/04/24/rails_log_tagging/"],["Converting an Android Project to Maven","/blog/2013/04/16/Converting_an_Android_Project_to_Maven/"],["Oh! Map my rails!","/blog/2013/04/09/Oh_Map_my_rails/"],["mysql permissions","/blog/2013/04/09/mysql_permissions/"],["reset mysql slave","/blog/2013/03/29/reset_mysql_slave/"],["installing rmagick on 10.8 with homebrew","/blog/2013/02/14/installing_rmagick_on_108_with_homebrew/"],["NP-Completeness","/blog/2013/02/08/NP-Completeness/"],["Find and replace non-breaking spaces in vim","/blog/2013/02/01/Find_and_replace_non-breaking_spaces_in_vim/"],["Open Resty the Prebuilt Reverse Proxy","/blog/2013/02/01/Open_Resty_the_Prebuilt_Reverse_Proxy/"],["Sublime Text 2 Tweaks","/blog/2012/12/17/Sublime_Text_2_Tweaks/"],["Batch Convert CR2 to JPG","/blog/2012/12/01/Batch_Convert_CR2_to_JPG/"],["Androids in the wild","/blog/2012/06/30/Androids_in_the_wild/"],["Why you need database_cleaner","/blog/2012/06/11/Why_you_need_database_cleaner/"],["Find and replace in files on linux/unix","/blog/2012/05/12/Find_and_replace_in_files_on_linuxunix/"],["a pithy guide to railsconf 2012","/blog/2012/04/26/a_pithy_guide_to_railsconf_2012/"],["faster rails boot ruby 1.9.3 + debugger","/blog/2012/04/12/faster_rails_boot_ruby_193_debugger/"],["homebrew -- fix that nasty mysql.server start segfault","/blog/2012/03/29/homebrew_--_fix_that_nasty_mysqlserver_start_segfault/"],["read/write filesystem on rooted android for an ad-free android experience","/blog/2012/02/14/readwrite_filesystem_on_rooted_android_for_an_ad-free_android_experience/"],["Turn Wikipedia Back On","/blog/2012/01/17/Turn_Wikipedia_Back_On/"],["compiling qt4 on centos 5","/blog/2012/01/06/compiling_qt4_on_centos_5/"],["pip install pymongo with xcode 4","/blog/2011/08/09/pip_install_pymongo_with_xcode_4/"],["interactive python history -- better titled \"gimme some up arrow love\"","/blog/2011/08/05/interactive_python_history_--_better_titled_gimme_some_up_arrow_love/"],["Centos 5.5 yum repo sha256 fix","/blog/2011/07/27/Centos_55_yum_repo_sha256_fix/"],["Apple Keyboard for Android!","/blog/2011/07/15/Apple_Keyboard_for_Android/"],["jQuery Everywhere","/blog/2011/05/24/jQuery_Everywhere/"],["Django Migrations","/blog/2011/05/11/Django_Migrations/"],["RVM + Rails + Git + HTML5 Boiler Plate... What more could you possibly want?","/blog/2011/02/22/RVM_Rails_Git_HTML5_Boiler_Plate_What_more_could_you_possibly_want/"],["OneCast 2.0 - downloadable podcasts for androids of every color","/blog/2011/02/18/OneCast_20_-_downloadable_podcasts_for_androids_of_every_color/"],["Default Android Menu Icons in Your App","/blog/2011/02/17/Default_Android_Menu_Icons_in_Your_App/"],["Windows 7 x64 Android Development (ADB)","/blog/2010/11/06/Windows_7_x64_Android_Development_ADB/"],["Firefox Plugin - Watching for an Application Exit Event","/blog/2010/05/03/Firefox_Plugin_-_Watching_for_an_Application_Exit_Event/"],["Stop Redrawing a Fixed Orientation Android App","/blog/2010/03/08/Stop_Redrawing_a_Fixed_Orientation_Android_App/"]]' placeholder='Search' type='text'>
</div>
</form>
</li>
</ul>
</div>
</div>
</div>
</nav>

<div class='container'>
<div class='row row-offcanvas row-offcanvas-left'>
<!-- sidebar -->
<div class='col-xs-3 col-sm-3 sidebar-offcanvas'>
<div id='sidebar' role='navigation'>
<div class='sidebar-contents'>
<div class='row'>
<div class='col-lg-12 page-header'>
<a href='#top'>Contents</a>
</div>
</div>
<div class='row'>
<div class='col-lg-12 table-of-contents'>
<ul class="nav"><li><a class="type-h2" href="#how-to-choose-an-osd"><h2>How to choose an OSD</h2></a></li><ul><li><a class="type-h3" href="#micro-minimosd"><h3>Micro MinimOSD</h3></a></li>
<li><a class="type-h3" href="#minimosd"><h3>MinimOSD</h3></a></li>
<li><a class="type-h3" href="#stackable-minimosd"><h3>Stackable MinimOSD</h3></a></li>
<li><a class="type-h3" href="#power-distribution-board-with-a-minimosd"><h3>Power Distribution Board with a MinimOSD</h3></a></li>
<li><a class="type-h3" href="#aio-flight-controller"><h3>AIO Flight Controller</h3></a></li>
<li><a class="type-h3" href="#flight-controller-with-an-osd"><h3>Flight controller with an OSD</h3></a></li></ul>
<li><a class="type-h2" href="#parts"><h2>Parts</h2></a></li>
<li><a class="type-h2" href="#wiring"><h2>Wiring</h2></a></li><ul><li><a class="type-h3" href="#breakout"><h3>Breakout Pins</h3></a></li>
<li><a class="type-h3" href="#flashing"><h3>Flashing</h3></a></li>
<li><a class="type-h3" href="#ide"><h3>Building the IDE</h3></a></li>
<li><a class="type-h3" href="#cleanflight-config"><h3>Cleanflight Configuration</h3></a></li>
<li><a class="type-h3" href="#osd-config"><h3>Scarab OSD Configuration</h3></a></li>
<li><a class="type-h3" href="#voltage-divider"><h3>Voltage Monitor</h3></a></li>
<li><a class="type-h3" href="#current-sensor"><h3>Current Sensing</h3></a></li><ul><li><a class="type-h4" href="#current-sensor-first-attempt"><h4>First attempt

</h4></a></li>
<li><a class="type-h4" href="#current-sensor-second-attempt"><h4>Second attempt

</h4></a></li></ul>
<li><a class="type-h3" href="#rssi"><h3>RSSI</h3></a></li></ul></ul>
</div>
</div>
<div class='row'>
<div class='col-lg-12 page-header'>
Related Articles
</div>
</div>
<div class='row'>
<div class='col-lg-12 related'>
<ul>
<li><a href="/blog/2016/02/03/rctimer-beerotorf3-flight-controller/">Rctimer BeerotorF3 Flight Controller</a></li>
<li><a href="/blog/2015/04/20/flashing-blheli-on-hobbyking-f20-escs-with-a-chinese-arduino-nano-clone/">Flashing BlHeli on HobbyKing F20 ESCs With a Chinese Arduino Nano Clone</a></li>
<li><a href="/blog/2015/11/16/flashing-xrotor-20a-with-blheli-via-4w-if/">Flashing SiLabs xRotor 20a with BlHeli via C2 4w-if</a></li>
<li><a href="/blog/2015/12/06/blheli-configuration/">BlHeli ESC Upgrading and Configuration</a></li>
<li><a href="/blog/2015/05/19/fpv250-cleanflight/">FPV250 with Cleanflight, Minimosd, OpenLRSng and a Xiaomi Yi GoPro Clone</a></li>
</ul>
</div>
</div>
<div class='row'>
<div class='col-lg-12 page-header text-center'>
<div class='drawer-footer'>
<small>
©
<a href='mailto:nathan@vertile.com'>Nathan Tsoi</a>
</small>
</div>
</div>
</div>
<div class='row connect'>
<div class='col-lg-12 text-center'>
<a class='btn-sm btn-default' href='https://github.com/nathantsoi' target='_blank'>
<i class='fa fa-github'></i>
</a>
<a class='btn-sm btn-default' href='https://bitbucket.org/nathantsoi' target='_blank'>
<i class='fa fa-bitbucket'></i>
</a>
<a class='btn-sm btn-default' href='https://twitter.com/nathantsoi/' target='_blank'>
<i class='fa fa-twitter'></i>
</a>
<a class='btn-sm btn-default' href='https://angel.co/nathantsoi' target='_blank'>
<i class='fa fa-angellist'></i>
</a>
<a class='btn-sm btn-default' href='https://linkedin.com/in/nattsoi/' target='_blank'>
<i class='fa fa-linkedin'></i>
</a>
<a class='btn-sm btn-default' href='https://facebook.com/nathantsoi' target='_blank'>
<i class='fa fa-facebook'></i>
</a>
<a class='btn-sm btn-default' href='https://plus.google.com/112518806102274696668' target='_blank'>
<i class='fa fa-google-plus'></i>
</a>
<a class='btn-sm btn-default' href='https://news.ycombinator.com/user?id=natvert' target='_blank'>
<i class='fa fa-hacker-news'></i>
</a>
<a class='btn-sm btn-default' href='https://trello.com/nathantsoi' target='_blank'>
<i class='fa fa-trello'></i>
</a>
</div>
</div>
</div>
</div>
</div>

<!-- main area -->
<div class='col-sm-9 col-xs-12' id='mainbar'>
<article>
<p>Putting together the flight controller for <a href="/blog/2015/05/19/fpv250-cleanflight/">my first mini quad</a> I decided on setting up a full-featured OSD.</p>

<div class="videoWrapper">
  <iframe width="560" height="315" src="https://www.youtube.com/embed/RSPe1rwKyac" frameborder="0" allowfullscreen></iframe>
</div>

<p>Long story short, the best firmware is ShikOfTheRa&#39;s fork of MWOSD: <a href="https://github.com/ShikOfTheRa/scarab-osd">scarab-osd</a></p>

<h2 id="how-to-choose-an-osd">How to choose an OSD</h2>

<p>There are lots of different OSD boards available on the market, but basically all of them are based on the &quot;MinimOSD&quot; design. At the core they are just a Arduino 328p processor and a MAX7456 chip that handles the text overlay. The only differences are form factor and power management.</p>

<p>From smallest to largest, the sizes are:</p>

<h3 id="micro-minimosd"><a href="http://www.banggood.com/MICRO-MinimOSD-Minim-OSD-Mini-OSD-W-KV-Team-MOD-For-Naze32-Flight-Controller-p-990556.html?p=1G09211226617201502J">Micro MinimOSD</a></h3>

<p><span class="center img-quarter-width"><a id="assets-images-blog-minimosd-devices-micro-minimosd-top-jpg" href="http://www.banggood.com/MICRO-MinimOSD-Minim-OSD-Mini-OSD-W-KV-Team-MOD-For-Naze32-Flight-Controller-p-990556.html?p=1G09211226617201502J" class="linked-img "><img data-ratio='1.010928961748634' data-src='../../../../../assets/images/blog/minimosd/devices/micro-minimosd-top-46619305.jpg' class='resize-ratio lazyload trailing-space' width='185' height='183'></img></a></span></p>

<p>You can tell that any one of these boards (or any other board) will run scarb-osd by identifying the MAX7456 chip and Atmel328p chips.</p>

<p>Here is what the MAX chip looks like:</p>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-devices-micro-minimosd-bottom-max-a-bccaa-jpg" href="../../../../../assets/images/blog/minimosd/devices/micro-minimosd-bottom-max-a7bccaa4.jpg" class="linked-img colorbox"><img data-ratio='1.0437158469945356' data-src='../../../../../assets/images/blog/minimosd/devices/micro-minimosd-bottom-max-a7bccaa4.jpg' class='resize-ratio lazyload trailing-space' width='191' height='183'></img></a></span></p>

<p>Here is what a small version of the Atmel chip looks like:</p>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-devices-micro-minimosd-top-atmel-bde-ec-jpg" href="../../../../../assets/images/blog/minimosd/devices/micro-minimosd-top-atmel-6bde60ec.jpg" class="linked-img colorbox"><img data-ratio='1.010928961748634' data-src='../../../../../assets/images/blog/minimosd/devices/micro-minimosd-top-atmel-6bde60ec.jpg' class='resize-ratio lazyload trailing-space' width='185' height='183'></img></a></span></p>

<p>And a pinout if you&#39;re using one of these:</p>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-devices-micro-minimosd-pinout-e-af-jpg" href="../../../../../assets/images/blog/minimosd/devices/micro-minimosd-pinout-e8289af6.jpg" class="linked-img colorbox"><img data-ratio='1.455790784557908' data-src='../../../../../assets/images/blog/minimosd/devices/micro-minimosd-pinout-e8289af6.jpg' class='resize-ratio lazyload trailing-space' width='1169' height='803'></img></a></span></p>

<h3 id="minimosd"><a href="http://www.banggood.com/MinimOSD-MAVLink-OSD-APM-APM2-Flight-Control-Board-p-73436.html?p=1G09211226617201502J">MinimOSD</a></h3>

<p><span class="center img-quarter-width"><a id="assets-images-blog-minimosd-devices-minimosd-b-e-jpg" href="../../../../../assets/images/blog/minimosd/devices/minimosd-b6e42636.jpg" class="linked-img colorbox"><img data-ratio='1.0' data-src='../../../../../assets/images/blog/minimosd/devices/minimosd-b6e42636.jpg' class='resize-ratio lazyload ' width='361' height='361'></img></a></span></p>

<p>There are quite a few variants of the MinimOSD form factor, the two biggest difference being if analog to digital (ADC) pins are broken out <a href="http://s.click.aliexpress.com/e/2ByNBAAAi">like on this one</a> and how the power management is done.</p>

<p>The best Minim OSD variants have a solder bridge that can be used to power the MAX chip over 5v instead of 12v, which is definitely the best way to go, since the MAX chip can easily burn out at anything over 5v. If the board doesn&#39;t have a solder bridge, you&#39;ll need to wire it up as I show below.</p>

<p>The <a href="http://www.banggood.com/MinimOSD-MAVLink-OSD-APM-APM2-Flight-Control-Board-p-73436.html?p=1G09211226617201502J">MinimOSD shown above</a> has a solder bridge (actually 2). Just connect the two sets of pads, one on the front and one on the back and you&#39;re good to go. Don&#39;t plug anything into the V+ on the camera side.</p>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-solder-pad-schematic-bfe-jpg" href="../../../../../assets/images/blog/minimosd/solder-pad-schematic-bfe86151.jpg" class="linked-img colorbox"><img data-ratio='1.098901098901099' data-src='../../../../../assets/images/blog/minimosd/solder-pad-schematic-bfe86151.jpg' class='resize-ratio lazyload trailing-space' width='500' height='455'></img></a></span></p>

<p>Here&#39;s what it looks like when the ADC pins are broken out. This is only useful if you want to send data to the OSD that does not come from the flight controller, such as an analog RSSI signal.</p>

<p><span class="center img-quarter-width"><a id="assets-images-blog-minimosd-devices-minimosd-breakout-a-b-jpg" href="http://s.click.aliexpress.com/e/2ByNBAAAi" class="linked-img "><img data-ratio='1.0' data-src='../../../../../assets/images/blog/minimosd/devices/minimosd-breakout-02a898b7.jpg' class='resize-ratio lazyload trailing-space' width='600' height='600'></img></a></span></p>

<h3 id="stackable-minimosd"><a href="http://www.banggood.com/FPV-OSD-On-Screen-Displayer-Support-10DOF-6DOF-Naze32-Flight-Controller-p-997445.html?p=1G09211226617201502J">Stackable MinimOSD</a></h3>

<p><span class="center img-quarter-width"><a id="assets-images-blog-minimosd-devices-minimosd-stackable-f-jpg" href="http://www.banggood.com/FPV-OSD-On-Screen-Displayer-Support-10DOF-6DOF-Naze32-Flight-Controller-p-997445.html?p=1G09211226617201502J" class="linked-img "><img data-ratio='1.0' data-src='../../../../../assets/images/blog/minimosd/devices/minimosd-stackable-255681f8.jpg' class='resize-ratio lazyload trailing-space' width='361' height='361'></img></a></span></p>

<p>If you&#39;ve got a stacking Flight Controller / PDB setup, you can get a <a href="http://www.banggood.com/FPV-OSD-On-Screen-Displayer-Support-10DOF-6DOF-Naze32-Flight-Controller-p-997445.html?p=1G09211226617201502J">stackable MinimOSD</a> to go with them.</p>

<h3 id="power-distribution-board-with-a-minimosd"><a href="http://www.banggood.com/FPV-OSD-On-Screen-Displayer-Support-10DOF-6DOF-Naze32-Flight-Controller-p-997445.html?p=1G09211226617201502J">Power Distribution Board with a MinimOSD</a></h3>

<p><span class="center img-quarter-width"><a id="assets-images-blog-minimosd-devices-minim-osd-pdb-bottom-b-fcc-jpg" href="http://www.banggood.com/FPV-OSD-On-Screen-Displayer-Support-10DOF-6DOF-Naze32-Flight-Controller-p-997445.html?p=1G09211226617201502J" class="linked-img "><img data-ratio='1.0' data-src='../../../../../assets/images/blog/minimosd/devices/minim-osd-pdb-bottom-3b910fcc.jpg' class='resize-ratio lazyload trailing-space' width='361' height='361'></img></a></span>
<span class="center img-quarter-width"><a id="assets-images-blog-minimosd-devices-minim-osd-pdb-top-dbcac-ac-jpg" href="http://www.banggood.com/FPV-OSD-On-Screen-Displayer-Support-10DOF-6DOF-Naze32-Flight-Controller-p-997445.html?p=1G09211226617201502J" class="linked-img "><img data-ratio='1.0' data-src='../../../../../assets/images/blog/minimosd/devices/minim-osd-pdb-top-dbcac7ac.jpg' class='resize-ratio lazyload trailing-space' width='361' height='361'></img></a></span></p>

<h3 id="aio-flight-controller"><a href="/blog/2015/11/09/rctimer-oze32-integrated-flight-controller-review-and-setup/">AIO Flight Controller</a></h3>

<p>If you&#39;re building a super-tiny quadcopter, like a <a href="/blog/2015/12/05/rctimer-micro-160-beerotor-build-setup-and-review/">Beerotor160</a> you can get a flight controller like the <a href="/blog/2015/11/09/rctimer-oze32-integrated-flight-controller-review-and-setup/">OZE32</a> which is a Naze32 + OSD + PDB all on a normal 35x35mm flight control board.</p>

<p><span class="center img-quarter-width"><a id="assets-images-blog-flight-controllers-oze-bc-fb-jpg" href="http://www.rctimer.com/product-1508.html/#r-pNathanT" class="linked-img "><img data-ratio='1.3341232227488151' data-src='../../../../../assets/images/blog/flight_controllers/oze32-3bc48fb9.jpg' class='resize-ratio lazyload trailing-space' width='563' height='422'></img></a></span></p>

<h3 id="flight-controller-with-an-osd"><a href="http://rctimer.com/product-1592.html/#r-pNathanT">Flight controller with an OSD</a></h3>

<p>Finally, if you want an F3 flight controller with a built-in OSD, grab a <a href="http://rctimer.com/product-1592.html/#r-pNathanT">BRF3 Flight Controller</a> and <a href="http://rctimer.com/product-1593.html">BRF3 PDB</a> (which includes the current sensor that enables the MAH consumption view on your OSD).</p>

<p><span class="center img-quarter-width"><a id="assets-images-blog-flight-controllers-brf-brf-bottom-abb-c-e-jpg" href="http://rctimer.com/product-1592.html/#r-pNathanT" class="linked-img "><img data-ratio='1.0019569471624266' data-src='../../../../../assets/images/blog/flight_controllers/brf3/brf3-bottom-abb4c5e1.jpg' class='resize-ratio lazyload trailing-space' width='2048' height='2044'></img></a></span></p>

<p>Let&#39;s get started</p>

<h2 id="parts">Parts</h2>

<p>Here are the parts that I used:</p>

<ul>
<li><p><a href="http://www.banggood.com/MinimOSD-MAVLink-OSD-APM-APM2-Flight-Control-Board-p-73436.html?p=1G09211226617201502J">MinimOSD from Banggood</a></p></li>
<li><p><a href="http://cgi.ebay.com/ws/eBayISAPI.dll?ViewItem&amp;item=281568666366">or get the MinimOSD from Ebay</a></p></li>
<li><p><a href="http://cgi.ebay.com/ws/eBayISAPI.dll?ViewItem&amp;item=370999422953">Current Sensor -- ACS758LCB-100U from Ebay</a></p>

<ul>
<li>Unidirectional 40mV/A</li>
<li>A hall effect instead of a shunt resistor. More efficient, but also slightly more expensive. Buy a shunt resistor if you want to save a few bucks. This stackexchange covers some of the pros/cons <a href="http://electronics.stackexchange.com/questions/57758/acs758-current-sensor-output-voltage-cannot-be-read-by-arduino#answer-57777">http://electronics.stackexchange.com/questions/57758/acs758-current-sensor-output-voltage-cannot-be-read-by-arduino#answer-57777</a></li>
<li>There are a bunch of great docs on this sensor over at Allegro Micro&#39;s <a href="http://www.allegromicro.com/en/Design-Center/Technical-Documents/Hall-Effect-Sensor-IC-Publications.aspx">publication page</a>.</li>
</ul></li>
</ul>

<h2 id="wiring">Wiring</h2>

<p>First, note that if you&#39;re going to get data from the flight controller, over the serial port. Breaking out the pins (other than voltage) is not necessary.</p>

<p><a href="http://fpvlab.com/forums/member.php?2197-Derrick">Derrick</a>, over at FPVLab wrote <a href="http://fpvlab.com/forums/showthread.php?24144-KV-OSD">this awesome post about wiring the minimosd</a>, and drew up this awesome diagram. Even though it&#39;s for a board with the A/D converter pins already broken out, it gets across the general idea</p>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-minimosd-wiring-e-png" href="../../../../../assets/images/blog/minimosd/minimosd-wiring-7539557e.png" class="linked-img colorbox"><img data-ratio='1.2541106128550075' data-src='../../../../../assets/images/blog/minimosd/minimosd-wiring-7539557e.png' class='resize-ratio lazyload trailing-space' width='839' height='669'></img></a></span></p>

<p>As it comes, the ebay minim osd uses 2 different voltages, 5v on the flight controller/atmega328p side and 12v on the video/max7456 side. Let&#39;s change that to use 5v from the flight controller on both sides. This serves two purposes, first it allows the chip to be powered by the UART-USB adapter, meaning you dont have to plug in your copter battery to upload font and second it ensures nothing burns out if we were to accidentally apply more than 12v on the video side of the chip. <a href="https://hoogvlieger.wordpress.com/2013/11/01/rctimer-minimosd-5v-mod/">Hoogvliger describes how to do this on his blog</a> for the v1 chip. I&#39;ve updated the photos for v2.</p>

<p>Remove the diode B2. Tape or clamp the board down, grab the diode with a pair of tweezers and heat one side with your iron. Pull that side off and do the other side</p>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-remove-diode-c-c-jpg" href="../../../../../assets/images/blog/minimosd/remove-diode-c0391c11.jpg" class="linked-img colorbox"><img data-ratio='1.3333333333333333' data-src='../../../../../assets/images/blog/minimosd/remove-diode-c0391c11.jpg' class='resize-ratio lazyload trailing-space' width='1024' height='768'></img></a></span></p>

<ul>
<li>Wire the flight controller side v5 to the linear voltage regulator. Solder the pin side first then pass the wire through the ISP header, flux the voltage regulator and tin the wire, it should stick right on, no extra solder needed.</li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-voltage-regulator-cff-jpg" href="../../../../../assets/images/blog/minimosd/voltage-regulator-26592cff.jpg" class="linked-img colorbox"><img data-ratio='1.3333333333333333' data-src='../../../../../assets/images/blog/minimosd/voltage-regulator-26592cff.jpg' class='resize-ratio lazyload trailing-space' width='1024' height='768'></img></a></span></p>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-DSC-cc-f-jpg" href="../../../../../assets/images/blog/minimosd/DSC05362-1cc9f759.jpg" class="linked-img colorbox"><img data-ratio='1.5036710719530102' data-src='../../../../../assets/images/blog/minimosd/DSC05362-1cc9f759.jpg' class='resize-ratio lazyload trailing-space' width='1024' height='681'></img></a></span></p>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-DSC-ca-jpg" href="../../../../../assets/images/blog/minimosd/DSC05361-490387ca.jpg" class="linked-img colorbox"><img data-ratio='1.5036710719530102' data-src='../../../../../assets/images/blog/minimosd/DSC05361-490387ca.jpg' class='resize-ratio lazyload trailing-space' width='1024' height='681'></img></a></span></p>

<ul>
<li><p>Jump the flight controller side GND to the video side ground</p></li>
<li><p>Note that when powering the OSD off the flight controller, any noise from the ESCs will go straight into your video signal. Therefore using a LC filter is crucial. My setup uses a LC filter followed by a 5v linear voltage regulator to power the flight controller and OSD.</p></li>
<li><p>The OSD connects to your cc3d like so:</p></li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-cc-d-wiring-f-png" href="../../../../../assets/images/blog/minimosd/cc3d-wiring-36496f82.png" class="linked-img colorbox"><img data-ratio='1.5686274509803921' data-src='../../../../../assets/images/blog/minimosd/cc3d-wiring-36496f82.png' class='resize-ratio lazyload trailing-space' width='800' height='510'></img></a></span></p>

<h3 id="breakout">Breakout Pins</h3>

<ul>
<li><p>This step adds pin headers to the analog to digital converters on the atmega328p microcontroller. This is only useful if you plan to directly connect analog pins straight to the OSD, ie. plug the battery voltage divider or current sensor output into the OSD. I did this originally because my reciever didn&#39;t have PPM, and I therefore did not have enough ADCs on my flight controller, but then I switched to an RX with PPM, and so I now plug the sensors straight into my flight controller and get this data over the serial connection to the flight controller. Long story short, skip this if you&#39;re plugging your sensors into your flight controller.</p></li>
<li><p>To know what pins to breakout on the atmega328p chip, let&#39;s read the code:</p>

<ul>
<li><a href="https://github.com/ShikOfTheRa/scarab-osd/blob/master/MW_OSD/Config.h#L182">Pinouts</a></li>
<li><a href="https://github.com/ShikOfTheRa/scarab-osd/blob/master/MW_OSD/Config.h#L245">Voltage Pinouts</a></li>
</ul></li>
</ul>
<pre class="highlight plaintext"><code>#define AMPERAGEPIN   A1
#define TEMPPIN       A6           
#define RSSIPIN       A3              
#define PWMRSSIPIN    A3              
#define LEDPIN        7

#define VOLTAGEPIN    A0
#define VIDVOLTAGEPIN A2
</code></pre>

<ul>
<li>So let&#39;s break out those pins on the chip, here&#39;s the Atmega328p pinout</li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-atmega-p-atmega-p-pinout-da-png" href="../../../../../assets/images/blog/atmega328p/atmega328p-pinout-3da94489.png" class="linked-img colorbox"><img data-ratio='1.3929058663028648' data-src='../../../../../assets/images/blog/atmega328p/atmega328p-pinout-3da94489.png' class='resize-ratio lazyload trailing-space' width='1021' height='733'></img></a></span></p>

<ul>
<li>Here&#39;s what it will look like when you&#39;re done. I&#39;ve broken out ground and A0-A3</li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-adc-breakout-d-c-jpg" href="../../../../../assets/images/blog/minimosd/adc-breakout-67d7c485.jpg" class="linked-img colorbox"><img data-ratio='1.3333333333333333' data-src='../../../../../assets/images/blog/minimosd/adc-breakout-67d7c485.jpg' class='resize-ratio lazyload trailing-space' width='1024' height='768'></img></a></span></p>

<p>&nbsp;</p>

<h3 id="flashing">Flashing</h3>

<ul>
<li><p><a href="https://www.silabs.com/products/mcu/Pages/USBtoUARTBridgeVCPDrivers.aspx">CP2102 Driver</a></p></li>
<li><p>Grab the latest firmware source <a href="https://github.com/ShikOfTheRa/scarab-osd">https://github.com/ShikOfTheRa/scarab-osd</a></p>

<ul>
<li><code>git clone https://github.com/ShikOfTheRa/scarab-osd.git</code> or download the <a href="https://github.com/ShikOfTheRa/scarab-osd/blob/master/DOCUMENTATION/Downloads.md">latest release</a>, use the download link if you don&#39;t want to build the GUI configurator</li>
</ul></li>
<li><p>Connect it like so</p></li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-cp-wiring-dddbd-jpg" href="../../../../../assets/images/blog/minimosd/cp2102-wiring-547dddbd.jpg" class="linked-img colorbox"><img data-ratio='1.3689839572192513' data-src='../../../../../assets/images/blog/minimosd/cp2102-wiring-547dddbd.jpg' class='resize-ratio lazyload trailing-space' width='1024' height='748'></img></a></span></p>

<ul>
<li>Open MW_OSD.ino with Arduino, <a href="http://www.arduino.cc/en/Main/Software">download and install Arduino</a>, if you don&#39;t have it already.</li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-upload-step-deb-f-png" href="../../../../../assets/images/blog/minimosd/upload-step1-deb5f925.png" class="linked-img colorbox"><img data-ratio='1.1716738197424892' data-src='../../../../../assets/images/blog/minimosd/upload-step1-deb5f925.png' class='resize-ratio lazyload trailing-space' width='546' height='466'></img></a></span>
&nbsp;</p>

<ul>
<li>Around line 22, uncomment the <code>CLEANFLIGHT</code> line and ensure all other lines in this section are commented out (start with <code>//</code>)</li>
</ul>
<pre class="highlight plaintext"><code>  /********************       CONTROLLER SOFTWARE      *********************/
  //Choose ONLY ONE option:-
  //#define MULTIWII_V24                // Uncomment this if you are using MW versions 2.4  
  //#define MULTIWII_V23              // Uncomment this if you are using MW versions 2.2/2.3  
  //#define MULTIWII_V21              // Uncomment this if you are using MW versions 2.0/2.1  (for BOXNAMES compatibility)
  //#define BASEFLIGHT                // Uncomment this if you are using BASEFLIGHT
  #define CLEANFLIGHT               // Uncomment this if you are using latest CLEANFLIGHT version from repository
  //#define CLEANFLIGHT180            // Uncomment this if you are using CLEANFLIGHT versions up to and including 1.8.0
  //#define CLEANFLIGHT181            // Uncomment this if you are using CLEANFLIGHT versions 1.8.1 
  //#define CLEANFLIGHT190            // Uncomment this if you are using CLEANFLIGHT versions 1.9
  //#define HARIKIRI                  // Uncomment this if you are using HARIKIRI (for BOXNAMES compatibility)
  //#define GPSOSD                    // Uncomment this if you are using a GPS module for a GPS based OSD
  //#define NOCONTROLLER              // Uncomment this if you ahave nothing connected to the serial port - no controller or GPS module
</code></pre>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-upload-step-f-a-a-png" href="../../../../../assets/images/blog/minimosd/upload-step2-f1a0913a.png" class="linked-img colorbox"><img data-ratio='1.7864923747276689' data-src='../../../../../assets/images/blog/minimosd/upload-step2-f1a0913a.png' class='resize-ratio lazyload trailing-space' width='820' height='459'></img></a></span>
&nbsp;</p>

<ul>
<li>Click the play button to upload and you should see:</li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-upload-step-df-dab-png" href="../../../../../assets/images/blog/minimosd/upload-step3-43df4dab.png" class="linked-img colorbox"><img data-ratio='7.37' data-src='../../../../../assets/images/blog/minimosd/upload-step3-43df4dab.png' class='resize-ratio lazyload trailing-space' width='737' height='100'></img></a></span>
&nbsp;</p>

<h3 id="ide">Building the IDE</h3>

<ul>
<li><p>You don&#39;t need to do this if you use the built version from the <a href="https://github.com/ShikOfTheRa/scarab-osd/blob/master/DOCUMENTATION/Downloads.md">latest release downloads page</a></p></li>
<li><p>Download <a href="https://processing.org/download/?processing">Processing</a> and <a href="http://www.sojamo.de/libraries/controlP5/download/controlP5-2.0.4.zip">controlP5</a></p></li>
<li><p>Extract and move controlp5 to the libraries folder:</p></li>
</ul>
<pre class="highlight plaintext"><code>  unzip controlP5-2.0.4.zip
  mv controlP5 ~/Documents/Processing/libraries
</code></pre>

<ul>
<li>Open <code>MW_OSD_GUI.pde</code> in Processing, you might see this, just click OK</li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-ide-step-b-png" href="../../../../../assets/images/blog/minimosd/ide-step1-05b14540.png" class="linked-img colorbox"><img data-ratio='2.0704607046070462' data-src='../../../../../assets/images/blog/minimosd/ide-step1-05b14540.png' class='resize-ratio lazyload trailing-space' width='764' height='369'></img></a></span>
&nbsp;</p>

<ul>
<li><p>Install the library by clicking <code>Sketch -&gt; Import library -&gt; add library</code> and picking the extracted controlP5 folder in the directory <code>~/Documents/Processing/libraries</code></p></li>
<li><p>Click the play button and you should see the app running</p></li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-ide-step-bfc-a-bd-png" href="../../../../../assets/images/blog/minimosd/ide-step2-bfc8a9bd.png" class="linked-img colorbox"><img data-ratio='2.9423076923076925' data-src='../../../../../assets/images/blog/minimosd/ide-step2-bfc8a9bd.png' class='resize-ratio lazyload trailing-space' width='459' height='156'></img></a></span>
&nbsp;</p>

<h3 id="cleanflight-config">Cleanflight Configuration</h3>

<ul>
<li><p>In CleanFlight configurator there is an option to send &quot;MultiWii Compatible current output,&quot; do not enable this checkbox.</p></li>
<li><p>The effect is twofold:</p></li>
</ul>
<pre class="highlight plaintext"><code>1. CleanFlight will allow negative values when this option is un-checked, which makes it possible to use a directional current sensor wired in either direction

2. Scarab OSD (when set to `#define CLEANFLIGHT` in `config.h`) will automatically adjust to the proper units, thereby reading the correct values
</code></pre>

<h3 id="osd-config">Scarab OSD Configuration</h3>

<ul>
<li><p>Note that when using &quot;Use FC...&quot; options, ie. using the data from the flight controller as opposed to the onboard analog to digital converters, the &quot;adjust&quot; fields have no effect.</p></li>
<li><p>Here&#39;s the <a href="https://github.com/ShikOfTheRa/scarab-osd/blob/master/DOCUMENTATION/User_Guide.md">user guide</a></p></li>
<li><p>Here&#39;s how to configure the sensors <a href="https://github.com/ShikOfTheRa/scarab-osd/blob/master/DOCUMENTATION/Calibration.md">Calibration Guide</a></p></li>
<li><p>My configuration looks like:</p></li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-scarab-osd-config-dd-fc-png" href="../../../../../assets/images/blog/minimosd/scarab-osd-config-19dd57fc.png" class="linked-img colorbox"><img data-ratio='1.6193820224719102' data-src='../../../../../assets/images/blog/minimosd/scarab-osd-config-19dd57fc.png' class='resize-ratio lazyload trailing-space' width='1153' height='712'></img></a></span></p>

<ul>
<li>Note I&#39;m using all data from &quot;FC&quot;, meaning all the sensor info comes from the flight controller.</li>
</ul>

<p>&nbsp;</p>

<h3 id="voltage-divider">Voltage Monitor</h3>

<ul>
<li><p>I soldered a voltage divider into the current sensor package R1 - 10k &amp; R2 - 2.2k. I didn&#39;t have any precision resistors (1%), but 5% seems to work fine.</p>

<ul>
<li>Given the voltage divider formula <code>Vout = Z2 / ((Z1 + Z2)) * Vin</code> where Z1 is a resistor in series between Vin and Vout and V2 is a resistor in series between Vout and ground, we get <code>Vout = (2.2k / (10k + 2.2k)) * Vin</code> =&gt; <code>Vout = .18 * Vin</code></li>
<li>Given Vout, the voltage that the microcontroller sees, <code>Vin = ((10k + 2.2k)/2.2k) * Vout</code> =&gt; <code>Vin = 5.54 * Vout</code></li>
<li>Cleanflight&#39;s calculation is basically: <code>Vbattery = Vout * vbat_scale</code> it&#39;s a little more complicated because of the ADC and rounding issues, but conceptually. That&#39;s what it&#39;s doing.</li>
<li>Cleanflight expects vbat<em>scale in decivolts so our value will be `vbat</em>scale = 55.4 = 55`</li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-voltage-divider-schematic-af-e-b-png" href="../../../../../assets/images/blog/voltage_divider/schematic-af94e8b3.png" class="linked-img colorbox"><img data-ratio='0.7773851590106007' data-src='../../../../../assets/images/blog/voltage_divider/schematic-af94e8b3.png' class='resize-ratio lazyload trailing-space' width='220' height='283'></img></a></span></p>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-voltage-divider-formula-e-png" href="../../../../../assets/images/blog/voltage_divider/formula-62e34969.png" class="linked-img colorbox"><img data-ratio='3.6666666666666665' data-src='../../../../../assets/images/blog/voltage_divider/formula-62e34969.png' class='resize-ratio lazyload trailing-space' width='165' height='45'></img></a></span></p></li>
</ul>

<p>&nbsp;</p>

<h3 id="current-sensor">Current Sensing</h3>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-DSC-cee-ae-jpg" href="../../../../../assets/images/blog/minimosd/DSC05364-2cee51ae.jpg" class="linked-img colorbox"><img data-ratio='1.5036710719530102' data-src='../../../../../assets/images/blog/minimosd/DSC05364-2cee51ae.jpg' class='resize-ratio lazyload trailing-space' width='1024' height='681'></img></a></span></p>

<ul>
<li><p>In summary</p>

<ul>
<li>0A -&gt; 0.6V</li>
<li>100A -&gt; 4.6V</li>
</ul></li>
<li><p>The ACS758LCB-100U is a unidirectionals 40mV/A sensor.</p>

<ul>
<li>Sensor sensitivity of 40mv/a means the sensor output voltage will increase 40mV each one Ampere of real current increment flowing through the sensor.

<ul>
<li>Therefore, when current is 100A the voltage will be 4v + the quiescent voltage (0.6, described below)</li>
</ul></li>
<li>Unidirectional means the sensor cannot detect which direction the current is flowing. Note that when wiring up the current sensor, DIRECTIONALITY MATTERS. The datasheet shows the power line must be connected like so:</li>
</ul></li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-acs-pinout-d-ddd-bc-png" href="../../../../../assets/images/blog/acs758/pinout-d9ddd3bc.png" class="linked-img colorbox"><img data-ratio='1.2535211267605635' data-src='../../../../../assets/images/blog/acs758/pinout-d9ddd3bc.png' class='resize-ratio lazyload trailing-space' width='178' height='142'></img></a></span></p>

<ul>
<li>For example, in this photo the pink wire goes to the positive lead on the battery and the blue wire goes to the positive lead on the quad:</li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-better-wiring-e-jpg" href="../../../../../assets/images/blog/minimosd/better-wiring-e1092779.jpg" class="linked-img colorbox"><img data-ratio='0.75' data-src='../../../../../assets/images/blog/minimosd/better-wiring-e1092779.jpg' class='resize-ratio lazyload trailing-space' width='768' height='1024'></img></a></span></p>

<ul>
<li>In the typical usage section this schematic is shown. I skipped the extra components and wired VIN straight from the 5v voltage regulator (described below) and VIOUT straight to pin 6 on the CC3D.</li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-acs-schematic-fa-b-png" href="../../../../../assets/images/blog/acs758/schematic-fa8119b3.png" class="linked-img colorbox"><img data-ratio='1.1973333333333334' data-src='../../../../../assets/images/blog/acs758/schematic-fa8119b3.png' class='resize-ratio lazyload trailing-space' width='449' height='375'></img></a></span></p>

<ul>
<li><p>Per the datasheet &quot;The ACS758 outputs an analog signal, VOUT , that varies linearly with the uni- or bi-directional AC or DC primary sampled current, IP, within the range specified&quot; In otherwords, the output is linear and proportional to the input voltage.</p></li>
<li><p>Because of ratiometry, the input voltage to the current sensor is important, so we&#39;ll use a 5v linear regulator to ensure the proper voltage. Ratiometric output means that the quiescent (when no current is passing through) voltage output, VIOUTQ, and the magnetic sensitivity, Sens, are proportional to the supply voltage, VCC.</p></li>
</ul>

<p><span class="center img-quarter-width">![ratiometric formula](blog/minimosd/ratiometric_formula.png&#39; %&gt;</p>

<ul>
<li><p>The output of the device when the primary current is zero, is defined in the datasheet, for unidirectional devices <code>= 0.12 × VCC</code> so our resting voltage will be <code>0.6</code> when no current is passing through.</p>

<ul>
<li>The datasheet also says -- variation in VIOUT(Q) can be attributed to the resolution of the Allegro linear IC quiescent voltage trim, magnetic hysteresis, and thermal drift.</li>
</ul></li>
<li><p>When setting the offset, remember it&#39;s almost impossible to see 0Amps under no-load conditions. In a real situation all your gear, mostly your AV TX, camera etc. will draw between 250mah and 400mah.</p></li>
</ul>

<p><h4 id="current-sensor-first-attempt">First attempt</h3></p>

<p>This was my first attempt to wiring the current sensor, use the second attempt method.</p>

<ul>
<li><p>Solder together a male and female XT-60 connector, putting the current sensor&#39;s big pins (they almost look like heatsinks) on the inline with the positive side. Directly connect the negative side of one XT-60 to the negative side of the other XT-60.</p>

<ul>
<li>I soldered these by tinning the 16awg wire and fluxing the pins then heating both for a moment.</li>
</ul></li>
<li><p>Pin 1 goes to VCC, +5V from a linear voltage regulator, GND goes to any common ground between the battery ground and the minimosd ground.</p></li>
<li><p>To test, I placed it inline w/ my battery charger (since we know the ouput of the charger)</p></li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-current-sensor-testing-ceed-jpg" href="../../../../../assets/images/blog/minimosd/current-sensor-testing-3812ceed.jpg" class="linked-img colorbox"><img data-ratio='1.5036710719530102' data-src='../../../../../assets/images/blog/minimosd/current-sensor-testing-3812ceed.jpg' class='resize-ratio lazyload trailing-space' width='1024' height='681'></img></a></span></p>

<ul>
<li>I found that the un-attached current sensor was un-reliable as the solder joints quickly wore when the leads from the current sensor to the XT-60 connector is so short. I decided to improve the reliability by doing a few things.</li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-broken-current-sensor-ce-jpg" href="../../../../../assets/images/blog/minimosd/broken-current-sensor-6182ce54.jpg" class="linked-img colorbox"><img data-ratio='1.3333333333333333' data-src='../../../../../assets/images/blog/minimosd/broken-current-sensor-6182ce54.jpg' class='resize-ratio lazyload trailing-space' width='1024' height='768'></img></a></span></p>

<p><h4 id="current-sensor-second-attempt">Second attempt</h3></p>

<p>This method worked much better.</p>

<ul>
<li><p>Attach the current sensor to a piece of plastic or something rigid to ensure it can be properly affixed to the quad and the wires are not stressed.</p></li>
<li><p>When soldering the current sensor, tin both the sensor leads and the wire. Then take some thin wire and wrap the wire (see the copper wire in the photo below) around both the wire and the sensor lead. This will create a physical connection, making the solder stronger. If you have flux, flux the whole assembly then heat with your iron turned up to around 750. It should all flow together as you add solder creating a very strong joint.</p></li>
<li><p>Don&#39;t use an indepenent linear voltage regulator, instead, I pulled 5v off an extra pin on the OSD that I added to the 5v pin. This 5v is after the LC filter, so the voltage should be much more stable.</p></li>
</ul>

<p><span class="center img-three-quarters-width"><a id="assets-images-blog-minimosd-better-wiring-b-daca-jpg" href="../../../../../assets/images/blog/minimosd/better-wiring-2-80b1daca.jpg" class="linked-img colorbox"><img data-ratio='1.3333333333333333' data-src='../../../../../assets/images/blog/minimosd/better-wiring-2-80b1daca.jpg' class='resize-ratio lazyload trailing-space' width='1024' height='768'></img></a></span></p>

<ul>
<li>Read more on <a href="https://code.google.com/p/rush-osd-development/wiki/Current_Sensing_Tutorial">the kvosd guide</a>, yes, this is different firmware but the electrical basics still apply.</li>
</ul>

<p>&nbsp;</p>

<h3 id="rssi">RSSI</h3>

<p>I tried making this work with my cheap HobbyKing T6 (FS-T6A TX/RX), but without hacking up the reciever, it seems impossible. </p>

<p>The T6 RX apparently uses an A7105 wireles chip which, according to the datasheet, &quot;A7105 has built-in 8-bits ADC do RSSI measurement as well as carrier detection function&quot; on pin 1. Per the datasheet, it seems like one could breakout a pin and make it possible:</p>
<pre class="highlight plaintext"><code>17.1 RSSI Measurement
A7105 supports 8-bits digital RSSI to detect RF signal strength. RSSI value is stored in ADC [7:0] (1Dh). Fig 17.1 shows a typical plot of RSSI reading as a function of input power. This curve is base on the current gain setting of A7105 reference code. A7105 automatically averages 8-times ADC conversion a RSSI measurement until A7105 exits RX mode. Therefore, each RSSI measuring time is ( 8 x 20 x FADC). For quick RSSI measurement, recommend to set FSARS = 1 (FADC =8MHz, 20 us measuring time). For power saving, recommend to set FSARS = 0 (FADC =4MHz, 40 us measuring time). Be aware RSSI accuracy is about ± 6dBm.

</code></pre>

<p>Instead of going this route, it was easier setting up OpenLRSng and using RSSI on channel 9 of the PPM signal as described on my <a href="/blog/2015/05/19/fpv250-cleanflight/">fpv250 post</a>. The scarab osd configurator should set the RSSI range from 0 to 255.</p>

<div class='text-center' style='margin: 1em'>
Checkout my other guides at
<a href='/blog'>nathan.vertile.com/blog</a>
</div>
<div id="disqus_thread"></div>
<script type="text/javascript">
//<![CDATA[
                  var disqus_shortname = 'vertile';
          
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
//]]>
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</article>

</div>
</div>
</div>
<script>
  var vglnk = { key: 'ddedf6f00d454f08b923376f1cb1cfbf' };
  
  (function(d, t) {
    var s = d.createElement(t); s.type = 'text/javascript'; s.async = true;
    s.src = '//cdn.viglink.com/api/vglnk.js';
    var r = d.getElementsByTagName(t)[0]; r.parentNode.insertBefore(s, r);
  }(document, 'script'));
</script>

</body>
</html>
